# 异步任务程序框架——AsyncTask  

## AsyncTask定义  
+ 一个Android已封装好的轻量级异步类。是一个**抽象类**，使用时须创建一个子类去继承它  
+ 一个简单的自定义AsyncTask可写成如下方式：  

```
public abstract class AsyncTask<Params, Progress, Result> { 
 ... 
 }  
```  

## AsyncTask作用  
+ 实现多线程
	+ 例：在主线程中执行耗时任务  

+ 异步通信、消息传递
	+ 实现工作线程、主线程（UI线程）之间的通信，即：将工作线程的执行结果传递给主线程，从而在主线程中执行相关的UI操作，保证线程安全  

## AsyncTask优点  
+ 方便实现异步通信
	+ 无需考虑异步消息处理机制，也无需专门使用Handler来发送和接收消息。
+ 节省资源
	+ 采用线程池的缓存线程和复用线程，避免了频繁创建或销毁线程所带来的系统资源开销  

## AsyncTask类与方法  

### AsyncTask类中3种泛型参数  

子类继承AsyncTask时可指定3个泛型参数，用途如下：  

|  泛型参数   | 用途  |
|  ----  | ----  |
| Params  | 开始异步任务执行时传入的参数类型，可用于在后台任务中使用 |
| Progress  | 异步任务执行过程中，若需要显示当前进度，则使用这里指定的泛型作为进度单位 |
| Result   | 异步任务执行完成后，返回的结果类型，与`doInBackground()`的返回值类型保持一致 |

### AsyncTask核心方法  


|  方法   | 作用  | 调用时刻 | 备注 |
|  ----  | ----  | ---- | ---- |
| `onPreExecute()`  | 执行线程任务前的操作 | 执行线程任务前系统自动调用 | 用于进行一些界面上的初始化操作，例如显示一个进度条对话框 |
| `doInBackground(Params…)`  | 接收输入参数，处理任务中的耗时操作，返回线程任务执行的结果 | 执行线程任务时系统自动调用 | 不可进行UI操作，如果需要更新UI元素，可以调用`publishProgress(Progress…)`方法来完成|
| `onProgressUpdate(Progress…)`| 在主线程显示线程任务执行的进度 | 调用`publishProgress(Progress…)`方法时，自动调用| 该方法可对UI进行操作，利用参数中的数值就可以对界面元素进行相应更新 |  
| `onPostExecute(Result)` | 接收线程任务的执行结果，将结果显示到UI组件 | 后台任务执行完毕时，自动调用 | 可利用返回数据进行一些UI操作，例如提醒任务执行结果、关闭进度条对话框等 |






